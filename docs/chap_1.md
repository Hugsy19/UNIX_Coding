# 基础知识

## 登录

- 用户的登录信息一般都保存在`/etc/passwd`中，各用户的登录项一般由7个以冒号分隔的字段组成。
  - 例如`root:x:0:0:root:/root:/bin/bash`；
  - 它们依次表示：登录名、密码、用户id、组id、注释、home目录、shell程序。
- 用户登录后即可向shell程序键入命令，UNIX中常见的shell有：
  - Bourne shell：即`/bin/sh`，由Steve Bourne在贝尔实验室开发；
  - C shell：即`/bin/csh`，由Bill Joy在伯克利开发，支持一些sh没有的特色功能；
  - Korn shell：即`/bin/ksh`，由贝尔实验室的David Korn开发，兼容sh并支持csh的特殊功能；
  - Bourne-again shell：即目前Linux中最常用的`/bin/bash`，设计遵循POSIX，保持与sh的兼容性的同时支持以上两者的特色功能。

## 文件与目录

- UNIX文件系统中，所有文件与目录都以根目录`/`为起点。
- 目录是包含目录项的文件，大多数UNIX实现中，文件属性都不会放在目录项中。
  - 因为当某个文件具有多个硬链接时，那样难以在多个副本间保持属性的同步。
  - 目录或文件的属性都存放在类型为`dirent`的结构体中，可通过`stat`进行读取。
- 创建新目录时都会自动新建两个文件`.`和`..`，分别指向当前目录和其父目录，且根目录中两者都指向当前目录。
- `<dirent.h>`中定义了`opendir`、`readdir`等可用来打开、读取目录信息的函数原型。
- 各进程都有一个工作目录，所有想对路径都是从工具目录开始解释。

## 输入和输出

- UNIX内核都用**文件描述符**（file description）来标识已打开的文件，它是一个小的非负整数。
- 运行新程序时，shell都会默认开启三个文件描述符：
  - 标准输入（standard input）
  - 标注输出（standard output）
  - 标准错误（standard error）
- I/O有带缓冲和不带缓冲之分，`open`、`close`、`write`、`lseek`及`close`都提供不带缓冲的I/O。
  - 它们的函数原型和几个标准I/O文件描述符一起，都定义在`<unistd.h>`。
- C标准库中定义的`printf`、`get`、`put`等标准I/O函数，则为不带缓冲的I/O提供了带缓冲的接口。

## 程序和进程

- 程序是存储在磁盘上某个目录中的**可执行文件**，内核通过`exec`来执行它们。
- **进程**（process）是程序的执行实例，UNIX系统的各个进程通过唯一的**进程ID**进行标识，它是一个非负整数。
  - 进程ID的数据类型为`pid_t`，可通过`getpid`获得。
- 进程主要通过`fork`、`exec`、`waitpid`这三个函数进行控制。
- 一个进程可有多个控制**线程**（thread），所有的线程共享进程的地址空间、文件描述符、栈等资源的同时保持独立。

## 错误处理

- 在`<errno.h>`中定义了整型变量`errno`及可以赋与它的，表示各种错误类型的以`E`开头的各种常量。
  - 其中定义的各种错误有**致命性**和**非致命性**之分，前者不可恢复。
- UNIX系统函数出错时，通常会返回负值或`null`，并把`errno`设定为特定值。
  - `strerror`可将参数`errno`映射为一个标识出错信息字符串。
  - `perror`则可根据当前的`errno`值，在标准错误上输出错误信息，通常直接将程序名作为实参传入。
- 对`errno`的设定包含两个规则：
  - 没有出错时，当前的程序不会改变其值，因此当且仅当程序的返回值表明程序出错时，才检验其值；
  - 表示各种错误类型的各种常量都不为`0`，因此任何函数都不该将`errno`的值设为`0`。

## 用户

## 信号

## 时间

## 系统调用与库函数